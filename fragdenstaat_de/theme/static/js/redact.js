!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.redact=e():(t.Froide=t.Froide||{},t.Froide.components=t.Froide.components||{},t.Froide.components.redact=e())}(window,function(){return function(t){function e(e){for(var r,o,i=e[0],c=e[1],l=e[2],d=0,f=[];d<i.length;d++)o=i[d],a[o]&&f.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(u&&u(e);f.length;)f.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(r=!1)}r&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={6:0},s=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(t){var e=[],n=a[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise(function(e,r){n=a[t]=[e,r]});e.push(n[2]=r);var s,i=document.getElementsByTagName("head")[0],c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(t){return o.p+""+({}[t]||t)+".js"}(t),s=function(e){c.onerror=c.onload=null,clearTimeout(l);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src,o=new Error("Loading chunk "+t+" failed.\n("+r+": "+s+")");o.type=r,o.request=s,n[1](o)}a[t]=void 0}};var l=setTimeout(function(){s({type:"timeout",target:c})},12e4);c.onerror=c.onload=s,i.appendChild(c)}return Promise.all(e)},o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o.oe=function(t){throw console.error(t),t};var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;return s.push(["../froide/frontend/javascript/redact.js",0]),n()}({"../froide/frontend/javascript/components/redaction/redaction.vue?vue&type=style&index=0&lang=scss&":function(t,e,n){"use strict";var r=n("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib/index.js?!./node_modules/resolve-url-loader/index.js?!./node_modules/sass-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!../froide/frontend/javascript/components/redaction/redaction.vue?vue&type=style&index=0&lang=scss&");n.n(r).a},"../froide/frontend/javascript/lib/vue-helper.js":function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){return t.replace(/(-\w)/g,function(t){return t[1].toUpperCase()})}function s(t,e){return function(){return e(t.tag,{domProps:{innerHTML:t.innerHTML}})}}function o(t,e){"string"==typeof t&&(t=document.querySelector(t));var n=function(t){for(var e=t.attributes,n={},r=0;r<e.length;r+=1){var s=e[r];if(("v"!==s.name[0]||"-"!==s.name[1])&&"id"!==s.name&&"class"!==s.name){var o=s.value,i=s.name;":"===s.name[0]&&(i=s.name.substring(1),"{"!==s.value[0]&&"["!==s.value[0]||(o=JSON.parse(s.value)),"true"===s.value&&(o=!0)),n[a(i)]=o}}return n}(t),o=function(t){for(var e=t.querySelectorAll("[slot]"),n={},r=0;r<e.length;r+=1){var a=e[r];n[a.attributes.slot.value]={tag:a.tagName.toLowerCase(),innerHTML:a.innerHTML}}return n}(t),i=function(t){var e={};if(t.id&&(e.attrs={id:t.id}),t.className){var n=t.className.split(" ");e.class={},n.forEach(function(t){e.class[t.trim()]=!0})}return e}(t);return function(t){var a=function(t,e){var n={};for(var r in t)n[r]=s(t[r],e);return n}(o,t);return t(e,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){r(t,e,n[e])})}return t}({props:n,scopedSlots:a},i))}}n.d(e,"a",function(){return o})},"../froide/frontend/javascript/redact.js":function(t,e,n){"use strict";n.r(e);var r=n("./node_modules/vue/dist/vue.runtime.esm.js"),a=n("../froide/frontend/javascript/lib/vue-helper.js"),s=(n("./node_modules/string.prototype.repeat/repeat.js"),n("./node_modules/lodash.range/index.js")),o=n.n(s),i=n("./node_modules/pdfjs-dist/build/pdf.js"),c=n.n(i);function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,a=!1,s=void 0;try{for(var o,i=t[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,s=t}finally{try{r||null==i.return||i.return()}finally{if(a)throw s}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var d={name:"redaction",props:["config","pdfPath","attachmentUrl","redactRegex","canPublish"],data:function(){return{doc:null,currentPage:null,page:null,numPages:null,containerId:"container-"+String(Math.random()).substr(2),canvasId:"canvas-"+String(Math.random()).substr(2),redactCanvasId:"redactCanvas-"+String(Math.random()).substr(2),textLayerId:"textlayer-"+String(Math.random()).substr(2),workingState:"loading",ready:!1,textOnly:!1,textDisabled:!1,scaleFactor:96/72,actionsPerPage:{},actionIndexPerPage:{},rectanglesPerPage:{},startDrag:null,endDrag:null,initialAutoRedact:{},errors:null,message:null,progressCurrent:null,progressTotal:null}},created:function(){var t=this;c.a.GlobalWorkerOptions.workerSrc=this.config.resources.pdfjsWorker,console.log(this.config.resources.pdfjsWorker,c.a),this.loadDocument().then(function(){return t.loadPage(1)})},computed:{i18n:function(){return this.config.i18n},hasNext:function(){return this.currentPage<this.numPages},hasPrevious:function(){return this.currentPage>1},canUndo:function(){return this.actionIndexPerPage[this.currentPage]>0},canRedo:function(){var t=this.actionsPerPage[this.currentPage];return void 0!==t&&this.actionIndexPerPage[this.currentPage]<t.length},pageOfTotal:function(){return null!==this.numPages?this.i18n.pageCurrentOfTotal.replace(/\$current/,this.currentPage).replace(/\$total/,this.numPages):""},regexList:function(){return this.redactRegex.map(function(t){return t=t.replace(/ /g,"\\s+"),new RegExp(t,"gi")})},container:function(){return document.getElementById(this.containerId)},canvas:function(){return document.getElementById(this.canvasId)},redactCanvas:function(){return document.getElementById(this.redactCanvasId)},textLayer:function(){return document.getElementById(this.textLayerId)},working:function(){return null!==this.workingState},loading:function(){return"loading"===this.workingState},redacting:function(){return"redacting"===this.workingState},sending:function(){return"sending"===this.workingState},progressUnknown:function(){return null===this.progressCurrent||void 0===this.progressTotal},progressPercent:function(){return this.progressUnknown?100:this.progressCurrent/this.progressTotal*100},progressWidth:function(){return"width: ".concat(this.progressPercent,"%")},csrfToken:function(){return document.querySelector("[name=csrfmiddlewaretoken]").value}},methods:{loadDocument:function(){var t=this,e=c.a.getDocument({url:this.pdfPath,isEvalSupported:!1});return e.onProgress=function(e){t.progressCurrent=e.loaded,t.progressTotal=e.total},e.promise.then(function(e){t.workingState=null,t.ready=!0,t.doc=e,t.numPages=t.doc.numPages;for(var n=1;n<=t.numPages;n+=1)r.a.set(t.actionsPerPage,n,[]),r.a.set(t.actionIndexPerPage,n,0);t.currentPage=1})},loadPage:function(t){var e=this;return this.doc.getPage(t).then(function(n){console.log("# Page "+t),e.page=n;var r=n.getViewport(e.scaleFactor);e.viewport=r,console.log("Size: "+r.width+"x"+r.height),console.log();var a=e.canvas;a.width=r.width,a.height=r.height,e.redactCanvas.width=r.width,e.redactCanvas.height=r.height,e.container.style.width=Math.floor(r.width)+"px",e.container.style.height=Math.floor(r.height)+"px",e.textLayer.style.width=Math.floor(r.width)+"px",e.textLayer.style.height=Math.floor(r.height)+"px";var s=a.getContext("2d"),o=n.render({canvasContext:s,viewport:r}),i=n.getTextContent().then(function(t){for(;e.textLayer.firstChild;)e.textLayer.removeChild(e.textLayer.firstChild);return c.a.renderTextLayer({textContent:t,container:e.textLayer,viewport:r,enhanceTextSelection:!0}).promise});return Promise.all([o.promise,i]).then(e.textAvailable)})},goNext:function(){this.hasNext&&this.setCurrentPage(this.currentPage+1)},goPrevious:function(){this.hasPrevious&&this.setCurrentPage(this.currentPage-1)},setCurrentPage:function(t){return this.currentPage=t,this.loadPage(t)},toggleText:function(){this.textOnly=!this.textOnly,this.textOnly&&(this.textDisabled=!1)},toggleDrawing:function(){this.textDisabled=!this.textDisabled,this.textDisabled&&(this.textOnly=!1)},redact:function(){var t=this;this.ready=!1,this.workingState="redacting",this.progressCurrent=0,this.progressTotal=this.numPages+1;var e=[];return o()(1,this.numPages+1).reduce(function(n,r){return n.then(function(){return t.setCurrentPage(r).then(function(){t.progressCurrent=r,e.push(t.serializePage(r))})})},Promise.resolve()).then(function(){return console.log(e),t.progressCurrent=null,t.sendSerializedPages(e).then(function(e){e.url?(t.progressCurrent=100,t.progressTotal=100,document.location.href=e.url):(t.workingState=null,t.errors=e)}).catch(function(e){t.workingState=null,console.error(e),t.ready=!0,t.redacting=!1,t.errors=e})})},sendSerializedPages:function(t){var e=this;return this.workingState="sending",this.progressCurrent=5,this.progressTotal=100,new Promise(function(n,r){var a=new window.XMLHttpRequest;a.open("POST",document.location.href),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-CSRFToken",e.csrfToken),(a.upload?a.upload:a).addEventListener("progress",function(t){t.lengthComputable?(e.progressCurrent=t.loaded,e.progressTotal=t.total):e.progressCurrent=null}),a.onreadystatechange=function(){if(4===a.readyState)return n(JSON.parse(a.responseText))},a.send(JSON.stringify(t))})},serializePage:function(t){var e=this,n=this.textLayer.children,r=Array.prototype.map.call(n,function(t){var n=u(e.getDivPos(t),2);return{pos:[n[0],n[1],t.offsetWidth,t.offsetHeight],fontFamily:t.style.fontFamily,fontSize:t.style.fontSize,transform:t.style.transform,text:t.textContent}});return{width:this.viewport.width,height:this.viewport.height,scaleFactor:this.scaleFactor,pageNumber:t,rects:this.rectanglesPerPage[t],texts:r}},getOffset:function(t){var e=(t.target||t.srcElement).getBoundingClientRect();return[t.clientX-e.left,t.clientY-e.top]},mouseMove:function(t){null!==this.startDrag&&(window.getSelection().isCollapsed&&(this.endDrag=this.getOffset(t),this.drawRectangles()))},mouseDown:function(t){this.startDrag=this.getOffset(t)},mouseUp:function(t){var e=this,n=window.getSelection();if(void 0!==n&&!n.isCollapsed)return console.log(n),this.startDrag=null,this.handleSelection(n),void n.removeAllRanges();if(null!==this.startDrag){var r=this.getOffset(t);if(Math.abs(r[0]-this.startDrag[0])<3&&Math.abs(r[1]-this.startDrag[1])<3)return console.log("Cancel empty select"),void(this.startDrag=null);var a=u(this.getRect(this.startDrag,r),4),s=a[0],o=a[1],i=a[2],c=a[3],l=this.textLayer.children,d=Array.prototype.filter.call(l,function(t){var n=u(e.getDivPos(t),2),r=n[0],a=n[1],l=t.offsetWidth,d=t.offsetHeight;return s<r+l&&s+i>r&&o<a+d&&o+c>a}).map(function(t){return e.redactText(t,0,t.textContent).texts[0]});this.addAction({type:"redact",rects:[[s,o,i,c]],page:this.currentPage,texts:d}),this.startDrag=null}},getRect:function(t,e){var n,r,a,s;return t[0]<e[0]?(n=t[0],a=e[0]-n):(n=e[0],a=t[0]-n),t[1]<e[1]?(r=t[1],s=e[1]-r):(r=e[1],s=t[1]-r),[n,r,a,s]},handleSelection:function(t){var e=this;function n(t){if(t.firstChild)return t.firstChild;for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}}for(var r=[],a=function(){var a=t.getRangeAt(s);if(a.isCollapsed)return"continue";if(a.startContainer===a.endContainer){var o=a.startContainer;"#text"===o.nodeName&&(o=o.parentNode);var i=e.redactRange(o,a.startOffset,a.endOffset);return r.push(i),"continue"}(function(t){var e,r=t.startContainer,a=t.endContainer,s=t.commonAncestorContainer,o=[];for(e=r.parentNode;e&&(o.push(e),e!==s);e=e.parentNode);for(o.reverse(),e=r;e&&(o.push(e),e!==a);e=n(e));return o})(a).forEach(function(t){var n=0,s=0;if(null!==t.textContent&&(s=t.textContent.length),t===a.startContainer?n=a.startOffset:t===a.endContainer&&(s=t.endOffset),"#text"===t.nodeName&&(t=t.parentNode),console.log(t,n,s),null!==t&&void 0!==t.dataset&&void 0!==t.dataset.index){var o=e.redactRange(t,n,s);r.push(o)}})},s=0;s<t.rangeCount;s+=1)a();var o=this.combineActions(r);this.addAction(o)},combineActions:function(t){return{type:"redact",texts:t.reduce(function(t,e){return t.concat(e.texts)},[]),rects:t.reduce(function(t,e){return t.concat(e.rects)},[]),page:this.currentPage}},textAvailable:function(){var t=this,e=0;Array.prototype.forEach.call(this.textLayer.children,function(t){t.dataset.index=e,e+=1}),void 0===this.initialAutoRedact[this.currentPage]&&(this.regexList.forEach(function(e){return t.autoRedact(e)}),r.a.set(this.initialAutoRedact,this.currentPage,!0)),this.applyActionsOnPageLoad()},drawRectangle:function(t,e){var n=u(e,4),r=n[0],a=n[1],s=n[2],o=n[3];t.fillStyle="#000",t.fillRect(r,a,s,o)},drawRectangles:function(){var t=this,e=this.redactCanvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),void 0!==this.rectanglesPerPage[this.currentPage]&&this.rectanglesPerPage[this.currentPage].forEach(function(n){t.drawRectangle(e,n)}),this.startDrag&&this.endDrag&&this.drawRectangle(e,this.getRect(this.startDrag,this.endDrag))},applyActionsOnPageLoad:function(){var t=this;void 0===this.rectanglesPerPage[this.currentPage]&&r.a.set(this.rectanglesPerPage,this.currentPage,[]),this.actionsPerPage[this.currentPage].forEach(function(e){t.applyAction(e,!0)}),this.drawRectangles()},undo:function(){if(this.canUndo){var t=this.actionIndexPerPage[this.currentPage];t-=1,r.a.set(this.actionIndexPerPage,this.currentPage,t);var e=this.actionsPerPage[this.currentPage][t];this.unapplyAction(e)}},redo:function(){if(this.canRedo){var t=this.actionIndexPerPage[this.currentPage],e=this.actionsPerPage[this.currentPage][t];t+=1,r.a.set(this.actionIndexPerPage,this.currentPage,t),this.applyAction(e)}},addAction:function(t){var e=this.actionsPerPage[t.page].slice();(e=e.slice(0,this.actionIndexPerPage[t.page])).push(t),r.a.set(this.actionsPerPage,t.page,e),r.a.set(this.actionIndexPerPage,t.page,this.actionsPerPage[t.page].length),this.applyAction(t)},applyAction:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0===this.rectanglesPerPage[t.page]&&r.a.set(this.rectanglesPerPage,t.page,[]),void 0===t.rects||n||(r.a.set(this.rectanglesPerPage,t.page,l(this.rectanglesPerPage[t.page]).concat(l(t.rects))),this.drawRectangles()),void 0!==t.texts&&t.texts.length>0&&t.texts.forEach(function(t){e.textLayer.querySelector('[data-index="'.concat(t.textIndex,'"]')).textContent=t.textAfter})},unapplyAction:function(t){var e=this;if(void 0!==t.rects&&t.rects.length>0){var n=this.rectanglesPerPage[t.page].filter(function(e){return 0===t.rects.filter(function(t){var n=u(t,4),r=n[0],a=n[1],s=n[2],o=n[3],i=u(e,4),c=i[0],l=i[1],d=i[2],f=i[3];return r===c&&a===l&&s===d&&o===f}).length});r.a.set(this.rectanglesPerPage,t.page,n),this.drawRectangles()}void 0!==t.texts&&t.texts.length>0&&t.texts.forEach(function(t){e.textLayer.querySelector('[data-index="'.concat(t.textIndex,'"]')).textContent=t.textBefore})},autoRedact:function(t){var e=this,n=this.textLayer.children,r=Array.prototype.filter.call(n,function(e){return e.textContent.match(t)});r.forEach(function(n){for(var r,a=n.textContent;r=t.exec(a);){var s=r.index,o=r[0],i=e.redactText(n,s,o);e.addAction(i)}}),r.length>0&&(this.message=this.i18n.autoRedacted)},getDivPos:function(t){return[parseInt(t.style.left.replace("px","")),parseInt(t.style.top.replace("px",""))]},redactText:function(t,e,n){return this.redactRange(t,e,e+n.length)},redactRange:function(t,e,n){var r=["█","▉","▊","▋","▌","▍","▎","▏"],a=[1,7/8,.75,5/8,.5,3/8,.25,1/8],s=t.textContent,o=s.substr(e,n-e);t.textContent=r[0];var i=t.offsetWidth;t.textContent=o;for(var c="",l=t.offsetWidth,d=0;d<r.length&&l>0;){var f=i*a[d];if(f>l)d+=1;else{var g=Math.floor(l/f);c+=r[d].repeat(g),l=l%f/f,d+=1}}t.textContent=s.substr(0,e);var h=t.offsetWidth;t.textContent=s.substr(0,e+o.length);var p=t.offsetWidth;t.textContent=s;var v=u(this.getDivPos(t),2),m=v[0],x=v[1];m+=h;var y=p-h,P=Math.min(1.2*t.offsetHeight,t.offsetHeight+10);return{type:"redact",texts:[{textIndex:t.dataset.index,textBefore:s,textAfter:s.replace(o,c)}],rects:[[m-2,x,y+4,P]],page:this.currentPage}}}},f=(n("../froide/frontend/javascript/components/redaction/redaction.vue?vue&type=style&index=0&lang=scss&"),n("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),g=Object(f.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pdf-redaction-tool",attrs:{id:"pdf-viewer"}},[t.message?n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-12"},[n("div",{staticClass:"alert alert-info",attrs:{role:"alert"}},[t._v(t._s(t.message))])])]):t._e(),t._v(" "),t.errors?n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-12"},[n("div",{staticClass:"alert alert-error",attrs:{role:"alert"}},[t._v(t._s(t.errors))])])]):t._e(),t._v(" "),t.working?n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-12"},[n("div",{staticClass:"text-center"},[t.loading?n("h3",[t._v("\n          "+t._s(t.i18n.loadingPdf)+"\n        ")]):t._e(),t._v(" "),t.redacting?n("h3",[t._v("\n          "+t._s(t.i18n.redacting)+"\n        ")]):t._e(),t._v(" "),t.sending?n("h3",[t._v("\n          "+t._s(t.i18n.sending)+"\n        ")]):t._e()]),t._v(" "),n("div",{staticClass:"progress"},[n("div",{staticClass:"progress-bar",class:{"progress-bar-striped":t.progressUnknown},style:t.progressWidth,attrs:{role:"progressbar","aria-valuenow":t.progressPercent,"aria-valuemin":"0","aria-valuemax":"100"}})])])]):t._e(),t._v(" "),n("div",{staticClass:"row toolbar"},[t.ready?n("div",{staticClass:"btn-toolbar col-lg-12"},[n("div",{staticClass:"btn-group mr-2"},[n("button",{staticClass:"btn btn-light",attrs:{disabled:!t.canUndo},on:{click:t.undo}},[n("i",{staticClass:"fa fa-undo"})]),t._v(" "),n("button",{staticClass:"btn btn-light",attrs:{disabled:!t.canRedo},on:{click:t.redo}},[n("i",{staticClass:"fa fa-repeat"})])]),t._v(" "),n("div",{staticClass:"btn-group mr-2"},[n("button",{staticClass:"pdf-prev btn btn-light",attrs:{disabled:!t.hasPrevious},on:{click:t.goPrevious}},[t._v("\n          «\n          "),n("span",{staticClass:"sr-only"},[t._v(t._s(t.i18n.previousPage))])]),t._v(" "),n("span",{staticClass:"input-group-text"},[t._v("\n          "+t._s(t.pageOfTotal)+"\n        ")]),t._v(" "),n("button",{staticClass:"pdf-next btn btn-light",attrs:{disabled:!t.hasNext},on:{click:t.goNext}},[n("span",{staticClass:"sr-only"},[t._v(t._s(t.i18n.nextPage))]),t._v("\n          »\n        ")])]),t._v(" "),n("div",{staticClass:"btn-group mr-2"},[n("button",{staticClass:"btn",class:{"btn-outline-info":!t.textOnly,"btn-info":t.textOnly},attrs:{title:t.i18n.toggleText},on:{click:function(e){return e.stopPropagation(),t.toggleText(e)}}},[n("i",{staticClass:"fa fa-align-justify"})]),t._v(" "),n("button",{staticClass:"btn",class:{"btn-outline-info":!t.textDisabled,"btn-info":t.textDisabled},attrs:{title:t.i18n.disableText},on:{click:function(e){return e.stopPropagation(),t.toggleDrawing(e)}}},[n("i",{staticClass:"fa fa-image"})])]),t._v(" "),n("div",{staticClass:"btn-group mr-1 ml-auto"},[n("button",{staticClass:"btn btn-primary",on:{click:t.redact}},[t._v("\n          "+t._s(t.i18n.redactAndPublish)+"\n        ")])]),t._v(" "),t.canPublish?n("div",{staticClass:"btn-group mr-4"},[n("form",{attrs:{method:"post",action:t.config.config.publishUrl}},[n("input",{attrs:{type:"hidden",name:"csrfmiddlewaretoken"},domProps:{value:t.csrfToken}}),t._v(" "),n("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[n("i",{staticClass:"fa fa-check"}),t._v("\n            "+t._s(t.i18n.publishWithoutRedaction)+"\n          ")])])]):t._e(),t._v(" "),t.canPublish?t._e():n("div",{staticClass:"btn-group mr-4"},[n("a",{staticClass:"btn btn-secondary",attrs:{href:t.attachmentUrl}},[t._v("\n          "+t._s(t.i18n.cancel)+"\n        ")])])]):t._e()]),t._v(" "),n("div",{staticClass:"row mt-3"},[n("div",{staticClass:"col-lg-12"},[n("div",{staticClass:"redactContainer",class:{"hide-redacting":t.working},attrs:{id:t.containerId}},[n("canvas",{directives:[{name:"show",rawName:"v-show",value:!t.textOnly,expression:"!textOnly"}],staticClass:"redactLayer",attrs:{id:t.canvasId}}),t._v(" "),n("canvas",{directives:[{name:"show",rawName:"v-show",value:!t.textOnly,expression:"!textOnly"}],staticClass:"redactLayer",attrs:{id:t.redactCanvasId},on:{mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.mouseUp}}),t._v(" "),n("div",{staticClass:"textLayer",class:{textActive:t.textOnly,textDisabled:t.textDisabled},attrs:{id:t.textLayerId},on:{mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.mouseUp}})])])]),t._v(" "),n("div",{staticClass:"row"},[t.ready?n("div",{staticClass:"btn-toolbar col-lg-12"},[n("div",{staticClass:"btn-group mr-auto ml-auto"},[n("button",{staticClass:"pdf-prev btn btn-light",attrs:{disabled:!t.hasPrevious},on:{click:t.goPrevious}},[t._v("\n          «\n          "+t._s(t.i18n.previousPage)+"\n        ")]),t._v(" "),n("span",{staticClass:"input-group-text"},[t._v("\n          "+t._s(t.pageOfTotal)+"\n        ")]),t._v(" "),n("button",{staticClass:"pdf-next btn btn-light",attrs:{disabled:!t.hasNext},on:{click:t.goNext}},[t._v("\n          "+t._s(t.i18n.nextPage)+"\n          »\n        ")])])]):t._e()])])},[],!1,null,null,null);g.options.__file="redaction.vue";var h=g.exports;function p(t){new r.a({components:{Redaction:h},render:Object(a.a)(t,h)}).$mount(t)}r.a.config.productionTip=!1,document.addEventListener("DOMContentLoaded",function(){p("#redact")});var v={createRedaction:p};e.default=v},"./node_modules/lodash.range/index.js":function(t,e){var n=1/0,r=9007199254740991,a=1.7976931348623157e308,s=NaN,o="[object Function]",i="[object GeneratorFunction]",c="[object Symbol]",l=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=/^(?:0|[1-9]\d*)$/,h=parseInt,p=Object.prototype.toString,v=Math.ceil,m=Math.max;function x(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function y(t){return t?(t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&p.call(t)==c}(t))return s;if(x(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=x(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(l,"");var n=d.test(t);return n||f.test(t)?h(t.slice(2),n?2:8):u.test(t)?s:+t}(t))===n||t===-n?(t<0?-1:1)*a:t==t?t:0:0===t?t:0}var P=function(t){return function(e,n,a){return a&&"number"!=typeof a&&function(t,e,n){if(!x(n))return!1;var a=typeof e;return!!("number"==a?function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=x(t)?p.call(t):"";return e==o||e==i}(t)}(n)&&function(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||g.test(t))&&t>-1&&t%1==0&&t<e}(e,n.length):"string"==a&&e in n)&&function(t,e){return t===e||t!=t&&e!=e}(n[e],t)}(e,n,a)&&(n=a=void 0),e=y(e),void 0===n?(n=e,e=0):n=y(n),function(t,e,n,r){for(var a=-1,s=m(v((e-t)/(n||1)),0),o=Array(s);s--;)o[r?s:++a]=t,t+=n;return o}(e,n,a=void 0===a?e<n?1:-1:y(a),t)}}();t.exports=P},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/index.js?!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib/index.js?!./node_modules/resolve-url-loader/index.js?!./node_modules/sass-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!../froide/frontend/javascript/components/redaction/redaction.vue?vue&type=style&index=0&lang=scss&":function(t,e,n){},0:function(t,e){},1:function(t,e){},2:function(t,e){}})});
//# sourceMappingURL=redact.js.map